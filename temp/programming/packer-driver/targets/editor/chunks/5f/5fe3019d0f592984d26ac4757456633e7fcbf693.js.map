{"version":3,"sources":["file:///Users/super_javan/cocoscreator/littleBeastFight3.6/assets/Battle/Script/games/fire/OnFire.ts"],"names":["OnFire","es","emit","fire","on","eventName","cb","once","push","group","onGroup","params","listeners","l","length","i","apply","splice","offGroup","esKey","off","undefined","ver"],"mappings":"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","sourcesContent":["/**\n * mini (~500 b) version for event-emitter.\n *\n * Created by hustcc on 2018/12/31\n * Contract: vip@hust.edu.cn\n */\n\nexport interface Listener {\n    cb: Function;\n    once: boolean;\n    group: any;\n}\n\nexport interface EventsType {\n    [eventName: string]: Listener[];\n}\n\n/**\n * const ee = new OnFire();\n *\n * ee.on('click', (...values) => {});\n *\n * ee.on('mouseover', (...values) => {});\n *\n * ee.emit('click', 1, 2, 3);\n * ee.fire('mouseover', {}); // same with emit\n *\n * ee.off();\n */\nexport default class OnFire {\n\n    static ver = '__VERSION__';\n\n    // 所有事件的监听器\n    es: EventsType = {};\n\n    on(eventName: string, cb: Function, once: boolean = false) {\n        if (!this.es[eventName]) {\n            this.es[eventName] = [];\n        }\n        this.es[eventName].push({\n            cb,\n            once,\n            group: \"\"\n        });\n    }\n\n\n    onGroup(eventName: string, cb: Function, group: any) {\n        if (!this.es[eventName]) {\n            this.es[eventName] = [];\n        }\n        this.es[eventName].push({\n            cb,\n            once: false,\n            group\n        });\n    }\n\n    once(eventName: string, cb: Function) {\n        this.on(eventName, cb, true);\n    }\n\n    fire(eventName: string, ...params: any[]) {\n        const listeners = this.es[eventName] || [];\n\n        let l = listeners.length;\n\n        for (let i = 0; i < l; i++) {\n            const {cb, once} = listeners[i];\n\n            cb.apply(this, params);\n\n            if (once) {\n                listeners.splice(i, 1);\n                i--;\n                l--;\n            }\n        }\n    }\n\n\n    offGroup(group: any) {\n        for (let esKey in this.es) {\n            const listeners = this.es[esKey] || [];\n            let l = listeners.length;\n            for (let i = 0; i < l; i++) {\n                if (listeners[i].group === group) {\n                    listeners.splice(i, 1);\n                    i--;\n                    l--;\n                }\n            }\n        }\n    }\n\n    off(eventName?: string, cb?: Function) {\n        // clean all\n        if (eventName === undefined) {\n            this.es = {};\n        } else {\n            if (cb === undefined) {\n                // clean the eventName's listeners\n                delete this.es[eventName];\n            } else {\n                const listeners = this.es[eventName] || [];\n                // clean the event and listener\n                let l = listeners.length;\n                for (let i = 0; i < l; i++) {\n                    if (listeners[i].cb === cb) {\n                        listeners.splice(i, 1);\n                        i--;\n                        l--;\n                    }\n                }\n            }\n        }\n    }\n\n    // cname of fire\n    emit = this.fire;\n}\n"]}